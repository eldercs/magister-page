<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
        Дручевский Д.В., Федяев О.И. - Распознавание лиц человека статистическими методами из пакета Matlab
    </title>
</head>
<style>
    body {
        margin: 0;
    }

    header {
        padding-top: 10px;
    }

    header a {
        background-color: rgb(135, 169, 219);
        text-decoration: none;
        color: white;
        padding: 10px;
    }

    main {
        margin: 0 10px;
    }
</style>

<body>
    <header class="">
        <a href="index.html">Назад в библиотеку</a>
    </header>
    <main>
        <h1 style="text-align: center">
            Распознавание лиц человека статистическими методами из пакета Matlab
        </h1>
        <p style="text-indent: 0pt">
            <b>Автор:</b> Дручевский Д.В., Федяев О.И.<br />
            <b>Источник:</b> IV Международная научно-практическая конференция «Программная инженерия: методы и
            технологии разработки информационно-вычислительных систем» (ПИИВС-2022) – Донецк: ДонНТУ, 2022.
        </p>
        <h2>Аннотация</h2>
        <p style="text-indent: 0pt; margin-left: 20pt">
            <b>Дручевский Д.В., Федяев О.И. Распознавание лиц человека статистическими методами из пакета Matlab.
            </b><i>
                Статья посвящена разработке программной модели распознавания людей по изображению лиц с использованием
                алгоритма Eigenface и инструментов пакета MatLab. Алгоритм распознавания основан на статистическом
                методе главных компонент. Этапы подготовки и распознавания в модели реализованы на программном уровне и
                описаны математически. Анализ качества распознавания проведен на разных объёмах обучающего
                множества.</i>
        </p>
        <h2>Введение</h2>
        <p>
            Обработка изображений всегда была активной областью исследований. В области обработки изображений существует
            множество усовершенствований, инноваций, разработок и модификаций. В настоящее время научно-практическая
            деятельность в области компьютерного зрения постоянно расширяется, наполняясь новыми идеями и разработками.
            По оценкам специалистов среднестатистический человек может идентифицировать знакомое лицо в толпе с
            точностью 97,53%. Но это меньше по сравнению с современными алгоритмами, которые добились точности 99,8%. А
            в последние несколько лет они достигли практически совершенства [1].
        </p>
        <p>
            Существует много способов распознавания лица: метод гибкого сравнения на графах, нейронные сети, скрытые
            марковские модели, статистические методы и другие [2]. Все они по-разному решают проблемы, влияющие на
            качество систем распознавания – это изменение освещённости, положения головы, размера лица и др. В последние
            годы эффективные системы распознавания были построены на основе свёрточных нейронных сетей [2]. Для
            упрощения создания систем распознавания создано несколько специализированных библиотек (TensorFlow, Keras),
            предоставляющие разработчикам хорошие инструменты [2]. В последнюю версию пакета Matlab также включены
            программные средства для разработки систем распознавания [2].
        </p>
        <p>
            Цель выполненной работы состоит в исследовании эффективности методов и инструментальных средств,
            предлагаемых пакетом Matlab, для разработки программных моделей автоматического распознавания лиц,
            позволяющих строить на их основе реальные системы видеоконтроля за людьми. В частности, авторы
            проанализировали эффективность применения метода главных компонент (PCA) для решения задачи распознавания
            лиц [3]. Этот метод успешно применяется в статистике при интеллектуальном анализе данных для уменьшения
            пространства признаков без существенной потери информации. В задачах распознавания, где большие объёмы
            данных и важна скорость их обработки, вполне обосновано применить его для представления изображения лица
            вектором малой размерности (главных компонент), который сравнивается затем с эталонными векторами,
            занесёнными в базу данных.
        </p>
        <p>
            Разработанная программная модель распознавания лиц построена на основе алгоритма Eigenface, использующего
            статистический метод главных компонент. Такой подход к автоматическому распознаванию не требует машинного
            обучения или свёрточной нейронной сети.
        </p>
        <h2>Схема распознавания лиц на основе программных средств пакета Matlab</h2>
        <p>
            Классическое решение задачи распознавания лиц человека включает несколько типовых этапов. Видеопоток
            изображений, на которых расположены лица людей, формируется видеокамерой в реальном масштабе времени. Далее
            выполняется детектирование, локализация и нормализация лиц на изображении. На третьем этапе формируются
            характерные признаки распознаваемого лица, по которым путём сравнения с базой эталонных лиц осуществляется
            распознавание человека. На рис.1 показана функциональная схема описанного классического подхода к
            распознаванию людей по лицам.
        </p>
        <p>
            Такая система компьютерного зрения должна предусматривать этап обучения на распознавание заданного
            контингента людей. Для этого предварительно проводятся следующие этапы: подготовка данных о распознаваемых
            людях и их оцифровка, формирование признаков лиц методом обучения и загрузка в базу данных необходимой
            информации о лицах.
        </p>
        <p style="text-align: center">
            <img src="./images/scem3.png" alt="" />
        </p>
        <p style="text-align: center">
            Рис. 1. Структура системы распознавания лиц на основе MatLab
        </p>
        <p>
            В данной статье рассматривается только программная реализация средствами пакета Matlab отдельных блоков
            структуры на рис.1, которые обведены пунктирной линией. Таким образом, изображения лиц поступали не из
            видеопотока, а брались из готовой базы, а именно, из стандартной датасет лаборатории ORL (AT&T), в которой
            изображения лиц представлены на однородном фоне с разрешением 92х112 пикселей [3]. Эта датасет содержит
            изображения лиц 40 людей в 10 различных ракурсах (всего 400 изображений). Изображения из датасет получены с
            различной освещённостью, положением головы, с очками и без, открытыми и закрытыми глазами.
        </p>
        <p>
            Рассмотрим технологию подготовки набора данных ORL для распознавания лиц средствами пакета Matlab. Для
            отдельного человека создана своя папка с именами(s1, s2, s3, … ,s40), каждая из них содержит 10 файлов с
            числовыми именами (1, 2, 3, … , 10) изображений этого человека с фронтальным лицом [4]. Изображения
            представлены в оттенках серого цвета.
        </p>
        <p>
            Для оцифровки и загрузки изображений лиц из базы данных в модуль распознавания была создана на языке Matlab
            специальная функция load_database, текст которой изображён на рис. 2. Функция возвращает числовую форму
            изображений.
        </p>
        <p style="text-align: center">
            <img src="./images/code3.png" alt="" />
        </p>
        <p style="text-align: center">
            Рис. 2. Фрагмент кода программы для пакета Matlab загрузки видеоданных о лицах
        </p>
        <p>Функция load_database весь обучающий набор лиц преобразует функцией reshape в одну общую матрицу данных
            all_Images (10304x400), где каждый столбец представляет собой один экземпляр плоского изображения лица
            (92x112 = 10304 пикселей), развёрнутого в столбец. Все лица обучающего набора приведены к одному размеру.
            Внутри двух циклов с помощью функции strcat происходит объединение папок, а потом с помощью функции imread
            выполняется загрузка всех изображений в матрицу all_Images с последующим преобразованием данных в 8-битные
            целые числа без знака. Схема преобразования показана на рис.3. На этом рисунке n=400, m=92, p=112, m x p =
            10304.</p>
        <p style="text-align: center">
            <img src="./images/faces3.1.png" alt="" />
        </p>
        <p style="text-align: center">
            Рис. 3. Преобразование обучающего набора лиц в одну общую матрицу
        </p>
        <p>Факт загрузки базы лиц в модуль распознавания отмечается присвоением единицы постоянной переменной loaded,
            чтобы не происходила повторная загрузка во время работы модуля распознавания. Примеры изображений лиц из
            датасет ORL показаны на рис.4.</p>
        <p style="text-align: center">
            <img src="./images/faces3.2.png" alt="" />
        </p>
        <p style="text-align: center">
            Рис. 4. Примеры лиц из базы данных ORL, используемой для обучения модуля распознавания
        </p>
        <h2>Распознавание лиц на основе статистического подхода</h2>
        <p>
            В данной работе задача распознавания лиц решалась методом главных компонент (Principal component analysis,
            PCA) [5]. Этот метод хорошо проработан математически, достаточно простой в реализации по сравнению с
            методами машинного обучения или моделями искусственных нейронных сетей. Кроме того, в пакете Matlab есть все
            средства для его программной реализации.
        </p>
        <p>
            Для реализации интерфейса системы будет использоваться HTML и CSS. Для
            функционирования базы данных WEB-системы будет использоваться свободная
            реляционная система управления базами данных СУБД MySQL версии 5.7.
            Разработанная физическая модель данных (рис. 3) содержит подробную
            информацию о каждом атрибуте, а также описание всех таблиц. В качестве
            Web-сервера был выбран OpenServer, который содержит Apache. Apache
            позволяет подключать различные модули, добавляющие в него новые
            возможности, а также он обладает надежностью, гибкими настройками и
            безопасностью.
        </p>
        <p>
            Основное достоинство метода – значительное уменьшение размерности пространства признаков, сохраняющих
            индивидуальность описания; способность выявлять различные «изменчивости» в обучающей выборке изображений лиц
            и описывать эту «изменчивость» в базисе нескольких ортогональных собственных векторов.
        </p>
        <p>Для работы модуля распознавания на этапе подготовки данных была сформирована специальным образом (см. рис.3)
            матрица всех изображения all_Images (обозначим её Х), размерность которой определяется по одной из координат
            количеством изображений n , а по второй - количеством пикселей в каждом изображении лица d = m x p. Для
            большей объективности проведена нормализация матрицы Х с учётом 0-го среднего и 1-й дисперсии:</p>
        <p style="text-align: center">
            <img src="./images/functions3.1.png" alt="" />
        </p>
        <p>Для нормализованной матрицы Х(d x n) находим ковариационную матрицу S(d x d), элементы которой определяют
            корреляции между всеми парами переменных (пикселей). Ковариационная матрица S набора Х разлагается на
            матрицу собственных векторов W(d x d) и диагональную матрицу собственных значений Λ(d x d), которые связаны
            каноническим уравнением</p>
        <p style="text-align: center">
            <img src="./images/functions3.3.png" alt="" />
        </p>
        <p>Ранжируя собственные вектора W в порядке убывания их собственных значений 𝜆, оставляем только первые k
            векторов по правилу</p>
        <p style="text-align: center">
            <img src="./images/functions3.2.png" alt="" />
        </p>
        <p>В результате отбрасывания менее значимых векторов мы из матрицы W оставляем главные компоненты (признаки) в
            виде подматрицы V(d x k), в столбцах которой располагаются наиболее значимые собственные вектора. Это первый
            шаг к уменьшению размерности исходных данных, т.к. k &lt; d. Учитывая, что исходная матрица изображений лиц
            Х
            осталась неизменной (не считая операцию нормализации), можно трансформировать Х, т.е. переориентировать
            данные Х с исходных осей на оси, представленные главными компонентами. Это выполняется путём
            перемножения транспонированной матрицы главных компонент V(d x k) на исходный набор Х(d х n), в
            результате получим новое более компактное описание эталонной базы лиц Х (all_Images) в виде другой
            матрицы Y(k x n) </p>
        <p style="text-align: center">
            <img src="./images/functions3.4.png" alt="" />
        </p>
        <p>Данный метод оставляет в Y самые значительные особенности описания лиц в форме Х . Таким образом,
            используя ограниченное количество собственных векторов, получаем сжатую аппроксимацию входных
            изображений лиц, которые затем храним в базе данных в виде векторов коэффициентов, служащих
            одновременно ключами поиска в базе данных лиц. </p>

        <p>Полученный один раз на обучающем множестве лиц набор собственных векторов V используется для кодирования всех
            остальных изображений лиц, которые представляются взвешенной комбинацией этих собственных векторов. Поэтому
            процесс распознавания нового лица Z(d x 1) заключается в сравнении его двойника F(k x 1), получаемого путём
            трансформации Z по осям главных компонент V.</p>
        <p style="text-align: center">
            <img src="./images/functions3.5.png" alt="" />
        </p>
        <p>C векторами компактной базы лиц Y на основе евклидовой метрики [6] . На рис. 4 изображён результат выполнения
            модуля распознавания [6].</p>
        <p style="text-align: center">
            <img src="./images/faces3.3.png" alt="" />
        </p>
        <p style="text-align: center">
            Рис. 5. Результат обработки изображения приложением
        </p>
        <h2>Оценка качества модели распознавания</h2>
        <p>
            Анализ разработанной программной модели распознавания проведен на стандартной базе данных ORL, включающей
            400 лиц. В качестве тестовых изображений выбирались случайным образом лица, входящие в используемую базу.
            Проведено исследование влияния количества лиц одного человека в обучающем множестве на качество
            распознавания (см. рис 6). Из экспериментов было выявлено, что при подаче на обучение 10 изображений 1
            человека вероятность правильного распознавания составляет около 94%.
        </p>
        <p style="text-align: center">
            <img src="./images/graph3.png" alt="" />
        </p>
        <p style="text-align: center">
            Рис. 6. Зависимость качества распознавания от размера обучающего множества: N - количество лиц одного
            человека в обучающем множестве
        </p>

        <h2>Заключение</h2>
        <p>
            Разработана программная модель распознавания людей по изображению лиц с использованием алгоритма Eigenface и
            инструментов пакета MatLab. Алгоритм распознавания основан на статистическом методе главных компонент. Этапы
            подготовки и распознавания в модели реализованы на программном уровне и описаны математически. Анализ
            качества распознавания проведен на разных объёмах обучающего множества.
        </p>
        <p>Выполненная работа показала, что используемый алгоритм распознавания, основанный на методе главных компонент,
            является крайне простым и может быть использован для распознавания лиц наряду с нейронными сетями. У
            алгоритма есть недостатки, такие как: чувствительность к уровню освещённости видеоизображений, низка
            скорость распознавания и слабая дискриминация между классами лиц.</p>
        <h2>Литература</h2>
        <ol>
            <li>
                Хабр [Электронный ресурс] - Режим доступа: https://habr.com/ru/company/droider/blog/568764/ -Загл. с
                экрана.
            </li>
            <li>
                Брилюк Д.В., Старовойтов В.В. Распознавание человека по изображению лица нейросетевыми методами -
                2002. - вып. 1. - с. 4-11. - URL:
                http://uiip.bas-net.by/structure/l_ori/starovoitov/Starovoitov_Publication_section/11_Starovoitov02prep.pdf.
            </li>
            <li>
                ML | Face Recognition Using Eigenfaces (PCA Algorithm) [Электронный ресурс] - Режим доступа:
                https://www.geeksforgeeks.org/ml-face-recognition-using-eigenfaces-pca-algorithm/ - Загл. с экрана.
            </li>
            <li>
                Face Recognition using Matlab [Электронный ресурс] - Режим доступа:
                https://www.nzfaruqui.com/face-recognition-using-matlab/ - Загл. с экрана.
            </li>
            <li>
                Face Recognition using Eigenfaces and Distance Classifiers [Электронный ресурс] - Режим доступа:
                https://onionesquereality.wordpress.com/2009/02/11/face-recognition-using-eigenfaces-and-distance-classifiers-a-tutorial/
                - Загл. с экрана.
            </li>
            <li>
                Распознавание изображений. Алгоритм Eigenface [Электронный ресурс] - Режим доступа:
                https://habr.com/ru/post/68870/ - Загл. с экрана.
            </li>
        </ol>
    </main>
</body>

</html>